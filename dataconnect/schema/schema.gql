# 1. Properties
# We removed the arrays (users, bookings) because the compiler bans them.
# You query them using "bookings(where: {propertyId: ...})" instead.
type Property 
  @table(name: "properties") 
  
{
  id: UUID! @default(expr: "uuidV4()")
  name: String! 
  address: String 
  phoneNumber: String 
  email: String 
}

# 2. Users
type User @table(name: "users") {
  id: String! @col(name: "uid") 
  email: String!
  role: String!
  name: String
  pin: String
  status: String # Active, On-Break, Out
  lastActive: Date
  
  # Link to Property
  propertyId: UUID
  property: Property 
}

# 3. Bookings
type Booking @table(name: "bookings") {
  id: UUID! @default(expr: "uuidV4()")
  guestName: String!
  checkInDate: Date!
  checkOutDate: Date!
  status: String!
  
  # Link to Property
  propertyId: UUID!
  property: Property!
  
  # Link to Room
  roomId: UUID
  room: Room
}

# 4. Rooms
# schema/schema.gql



# schema/schema.gql

type Room @table(name: "rooms") {
  # You must allow public access to the ID to read the result back
  id: UUID! @default(expr: "uuidV4()") @auth(level: PUBLIC)

  # Add @auth(level: PUBLIC) to EVERY field you are inserting
  roomNumber: String! @auth(level: PUBLIC)
  roomType: String! @auth(level: PUBLIC)
  floor: Int @auth(level: PUBLIC)
  roomStatus: String @auth(level: PUBLIC)
  capacity: Int @auth(level: PUBLIC)
  price: Float @auth(level: PUBLIC)
  
  # Crucial: You must allow access to the foreign key too
  propertyId: UUID! @auth(level: PUBLIC)
  property: Property!
}

